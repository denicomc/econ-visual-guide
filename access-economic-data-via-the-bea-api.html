<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="Introduction">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introduction" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  <meta name="twitter:description" content="Introduction" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="interactive-maps.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.0.27/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-1.1.0/leaflet-providers-plugin.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Guide to Economic Data + Interactive Visualization in R</a></li>
<li class="chapter" data-level="1" data-path="access-economic-data-via-the-bea-api.html"><a href="access-economic-data-via-the-bea-api.html"><i class="fa fa-check"></i><b>1</b> Access Economic Data via the BEA API</a><ul>
<li class="chapter" data-level="1.1" data-path="access-economic-data-via-the-bea-api.html"><a href="access-economic-data-via-the-bea-api.html#searching-for-data"><i class="fa fa-check"></i><b>1.1</b> Searching for data</a></li>
<li class="chapter" data-level="1.2" data-path="access-economic-data-via-the-bea-api.html"><a href="access-economic-data-via-the-bea-api.html#get-data"><i class="fa fa-check"></i><b>1.2</b> Get Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="interactive-maps.html"><a href="interactive-maps"><i class="fa fa-check"></i><b>2</b> Interactive Maps</a><ul>
<li class="chapter" data-level="2.1" data-path="interactive-maps.html"><a href="interactive-maps#get-bea-data"><i class="fa fa-check"></i><b>2.1</b> Get BEA data</a></li>
<li class="chapter" data-level="2.2" data-path="interactive-maps.html"><a href="interactive-maps#get-shapefile"><i class="fa fa-check"></i><b>2.2</b> Get shapefile</a></li>
<li class="chapter" data-level="2.3" data-path="interactive-maps.html"><a href="interactive-maps#process-and-join-data"><i class="fa fa-check"></i><b>2.3</b> Process and join data</a></li>
<li class="chapter" data-level="2.4" data-path="interactive-maps.html"><a href="interactive-maps#set-styles"><i class="fa fa-check"></i><b>2.4</b> Set styles</a></li>
<li class="chapter" data-level="2.5" data-path="interactive-maps.html"><a href="interactive-maps#render"><i class="fa fa-check"></i><b>2.5</b> Render</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="access-economic-data-via-the-bea-api" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Access Economic Data via the BEA API</h1>
<p>While BEA data can be accessed via the official website, programming-inclined users can easily access data through BEA’s Application Programming Interface (API), which is a common way of querying and retrieving data. For R Users, BEA has developed the <code>bea.R</code> library that is optimized for econometricians, statisticians, and data analysts. <code>bea.R</code> can be installed directly from CRAN:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;bea.R&quot;</span>)</code></pre></div>
<p>Upon installation, load the library:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bea.R)</code></pre></div>
<p>In order for BEA to understand user needs and to ensure a consistent, high level of service, the BEA API requires an API key – a simple 36 character code that opens access to data. The API key is free, asking for your name and email address: <a href="https://www.bea.gov/API/signup/index.cfm" class="uri">https://www.bea.gov/API/signup/index.cfm</a>. Upon submitting an API key request, the key will be emailed to you.</p>
<p>Once you have received your BEA API key, save it to a variable to make it easier to use later:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beaKey &lt;-<span class="st"> &quot;[36-Character-Key]&quot;</span></code></pre></div>
<div id="searching-for-data" class="section level2">
<h2><span class="header-section-number">1.1</span> Searching for data</h2>
<p>Much like using an index in a textbook, making a successful data retrieval request to the API requires specific information (e.g. variable series code, frequency, geographic units). The R library’s search functionality provides facility to easily surface the necessary information. Search is facilitated by the <code>beaSearch()</code> method, which requires two arguments: <em>keyword</em> and <em>beaKey</em>.</p>
<p>For example, the following keyword search returns a list of all datasets in which the term “Personal Consumption Expenditures” appears. One particularly important aspect of the search result is a pre-populated <em>API call</em> that jump starts the querying process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">beaSearch</span>(<span class="st">&#39;Personal Consumption Expenditures&#39;</span>, beaKey)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-16">Table 1.1: </span>Example results from through search interface.</caption>
<tbody>
<tr class="odd">
<td align="left">SeriesCode</td>
<td align="left">DPCERL</td>
<td align="left">DPCEDX</td>
</tr>
<tr class="even">
<td align="left">RowNumber</td>
<td align="left">20</td>
<td align="left">20</td>
</tr>
<tr class="odd">
<td align="left">LineDescription</td>
<td align="left">Personal consumption expenditures</td>
<td align="left">Personal consumption expenditures</td>
</tr>
<tr class="even">
<td align="left">LineNumber</td>
<td align="left">2</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">ParentLineNumber</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Tier</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Path</td>
<td align="left">2</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">TableID</td>
<td align="left">1</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">DatasetName</td>
<td align="left">NIPA</td>
<td align="left">NIPA</td>
</tr>
<tr class="even">
<td align="left">TableName</td>
<td align="left">Table 1.1.1. Percent Change From Preceding Period in Real Gross Domestic Product</td>
<td align="left">Table 1.1.6D. Real Gross Domestic Product, Chained (1992) Dollars</td>
</tr>
<tr class="odd">
<td align="left">ReleaseDate</td>
<td align="left">Dec 21 2017 8:30AM</td>
<td align="left">Aug 6 2015 12:00AM</td>
</tr>
<tr class="even">
<td align="left">NextReleaseDate</td>
<td align="left">Jan 26 2018 8:30AM</td>
<td align="left">Jan 1 1900 12:00AM</td>
</tr>
<tr class="odd">
<td align="left">MetaDataUpdated</td>
<td align="left">2017-12-21T21:24:27.427</td>
<td align="left">2017-12-21T21:24:27.427</td>
</tr>
<tr class="even">
<td align="left">Account</td>
<td align="left">National</td>
<td align="left">National</td>
</tr>
<tr class="odd">
<td align="left">apiCall</td>
<td align="left">beaGet(list(‘UserID’ = ‘[your_key]’, ‘Method’ = ‘GetData’, ‘DatasetName’ = ‘NIPA’, ‘TableID’ = ‘1’, …))</td>
<td align="left">beaGet(list(‘UserID’ = ‘[your_key]’, ‘Method’ = ‘GetData’, ‘DatasetName’ = ‘NIPA’, ‘TableID’ = ‘10’, …))</td>
</tr>
<tr class="even">
<td align="left">Key</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Desc</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Parameter</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>For some keyword searches, a sufficiently specific search will yield only a few results. Given the vast amount of data that BEA publishes, the search functionality will often return a sizable amount of candidate results. This may be more easily evaluated by specifying <code>asHtml = TRUE</code>, which presents search results in an interactive, searchable table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">beaSearch</span>(<span class="st">&#39;Final sales of computers to domestic purchasers&#39;</span>, beaKey, <span class="dt">asHtml =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="get-data" class="section level2">
<h2><span class="header-section-number">1.2</span> Get Data</h2>
<p>Using the sample API call from the above example, we will retrieve <em>Personal Consumption Expenditures</em> from <em>Table 1.1.1. Percent Change From Preceding Period in Real Gross Domestic Product</em>. But in short, it is <code>TableID = 1</code> from the <code>NIPA</code> dataset. Below, the list object specifies the relevant parameters, requesting the data at a quarterly frequency for all years.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">specs &lt;-<span class="st"> </span><span class="kw">list</span>(
    <span class="st">&#39;UserID&#39;</span> =<span class="st"> </span>beaKey,
    <span class="st">&#39;Method&#39;</span> =<span class="st"> &#39;GetData&#39;</span>,
    <span class="st">&#39;datasetname&#39;</span> =<span class="st"> &#39;NIPA&#39;</span>,
    <span class="st">&#39;TableID&#39;</span> =<span class="st"> &#39;1&#39;</span>,
    <span class="st">&#39;Frequency&#39;</span> =<span class="st"> &#39;Q&#39;</span>,
    <span class="st">&#39;Year&#39;</span> =<span class="st"> &#39;2010,2012,2013,2014&#39;</span>,
    <span class="st">&#39;ResultFormat&#39;</span> =<span class="st"> &#39;json&#39;</span>
)</code></pre></div>
<p>To retrieve a limited selection of multiple years, list all the years you want to retrieve. For example, to retrieve data for 2010 through 2014, use <code>&quot;Year&quot;=&quot;2010,2012,2013,2014&quot;</code>.</p>
<p>The <code>beaGet()</code> function can use the <code>spec</code> list to retrieve data. By default, the data are returned in wide form – each row is an indicator and each time period’s data is represented as a separate column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">beaGet</span>(specs);
<span class="kw">head</span>(df, <span class="dv">3</span>)</code></pre></div>
<pre><code>##    TableID TableName SeriesCode LineNumber
## 1:       1    T10101     A191RL          1
## 2:       1    T10101     DPCERL          2
## 3:       1    T10101     DGDSRL          3
##                      LineDescription           METRIC_NAME
## 1:            Gross domestic product Fisher Quantity Index
## 2: Personal consumption expenditures Fisher Quantity Index
## 3:                             Goods Fisher Quantity Index
##                        CL_UNIT UNIT_MULT DataValue_2010Q1 DataValue_2010Q2
## 1: Percent change, annual rate         0              1.7              3.9
## 2: Percent change, annual rate         0              2.2              3.3
## 3: Percent change, annual rate         0              4.0              5.2
##    DataValue_2010Q3 DataValue_2010Q4 DataValue_2012Q1 DataValue_2012Q2
## 1:              2.7              2.5              2.7              1.9
## 2:              2.6              4.2              2.4              0.7
## 3:              3.8              7.6              4.9              1.1
##    DataValue_2012Q3 DataValue_2012Q4 DataValue_2013Q1 DataValue_2013Q2
## 1:              0.5              0.1              2.8              0.8
## 2:              1.1              1.1              1.9              0.8
## 3:              2.7              2.3              5.7              1.3
##    DataValue_2013Q3 DataValue_2013Q4 DataValue_2014Q1 DataValue_2014Q2
## 1:              3.1              4.0             -0.9              4.6
## 2:              1.9              3.4              1.9              3.5
## 3:              2.9              4.0              2.4              6.2
##    DataValue_2014Q3 DataValue_2014Q4
## 1:              5.2              2.0
## 2:              3.9              5.1
## 3:              4.5              5.7</code></pre>
<p>For some use cases, in particular for time series models, obtaining the data in long form is desirable, which can be done by setting <code>asWide = FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">beaGet</span>(specs, <span class="dt">asWide =</span> <span class="ot">FALSE</span>);
<span class="kw">head</span>(df, <span class="dv">3</span>)</code></pre></div>
<p>In other cases, it may be more desirable to obtain the data in a form in which each column represents a variable, which is accomplished by setting <code>iTableStyle = FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">beaGet</span>(specs, <span class="dt">iTableStyle =</span> <span class="ot">FALSE</span>)
<span class="kw">head</span>(df, <span class="dv">3</span>)</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
